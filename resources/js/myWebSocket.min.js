function myWebSocket(n){this.handlers={};var t=this;this.messageHandler=null,this.defaultHandler=function(e){if(this.messageHandler&&"function"==typeof this.messageHandler&&this.messageHandler(e),e&&e.type){if(!(e.type in this.handlers))return;for(var n=this.handlers[e.type],t=0,o=n.length;t<o;t++)n[t](e)}},this.autoReconnect=!0,this.wsBindFuncs={open:function(e){console.log("on open",e)},message:function(e){console.log("on message",e);var n=JSON.parse(e.data);t.defaultHandler(n)},close:function(e){console.log("on close",e),t.autoReconnect&&setTimeout(function(){s()},5e3)},error:function(e){console.log("on error",e)}};var o=null;function s(){(o=new WebSocket(n)).onopen=t.wsBindFuncs.open,o.onmessage=t.wsBindFuncs.message,o.onclose=t.wsBindFuncs.close,o.onerror=t.wsBindFuncs.error}n&&s(),this.getWS=function(){return o},this.wsBind=function(e,n,t){this.wsBindFuncs[e]=t&&"object"==typeof t?n.bind(t):n},this.closeWS=function(){if(null!=o){var e=this.autoReconnect;this.autoReconnect=!1,o.close(),this.autoReconnect=e}},this.sendWS=function(e,n){var t={type:e,msg:n,date:Date.now()};o.send(JSON.stringify(t))},this.reStartWS=function(e){e&&(n=e),o=null,s()}}myWebSocket.prototype.setMessageHandler=function(e,n){this.messageHandler=n&&"object"==typeof n?e.bind(n):e},myWebSocket.prototype.addEventHandler=function(e,n){e in this.handlers||(this.handlers[e]=[]),"function"==typeof n&&this.handlers[e].push(n)},myWebSocket.prototype.addEventHandlers=function(e){for(var n in e)this.addEventHandler(n,e[n])},myWebSocket.prototype.removeEventHandler=function(e,n){if(e in this.handlers)for(var t=this.handlers[e],o=0,s=t.length;o<s;o++)if(t[o]===n)return void t.splice(o,1)},myWebSocket.prototype.removeHandlersByType=function(e){if(e in this.handlers){for(var n=this.handlers[e],t=0,o=n.length;t<o;t++)n.splice(t,1);delete this.handlers[e]}};